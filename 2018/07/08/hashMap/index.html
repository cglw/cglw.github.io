<html>
<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">

  
  <title>
    hashMap |
    Chen Gang
  </title>
  


  <meta name="description" content="I am g happy boy">
  <meta name="author" content="Chen Gang">
  <meta property="og:title" content="hashMap">
  <meta property="og:description" content="I am g happy boy">
  <meta property="og:site_name" content="Chen Gang">
  <meta property="og:image" content="http://lwcg.com/img/default.jpg">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:description" content="I am g happy boy">
  <meta name="twitter:title" content="hashMap">

  <meta name="twitter:image" content="http://lwcg.com/img/default.jpg">

  <script src="https://www.amcharts.com/lib/4/core.js"></script>
  <script src="https://www.amcharts.com/lib/4/charts.js"></script>
  <script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/style.css">

</head>

<body>
    <!-- Menu -->
    <nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark page-navbar gradient">
  <div class="container">
    <a class="navbar-brand logo" href="http://lwcg.com">
      Chen Gang</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
      aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav mx-auto">
        <li class="nav-item item">
          
        <li class="nav-item item">
          <a class="nav-link" href="/">
            Home</a>
        </li>
        
        <li class="nav-item item">
          <a class="nav-link" href="/archives">
            🗂️Archives</a>
        </li>
        
        <li class="nav-item item">
          <a class="nav-link" href="https://hexo.io/">
            Hexo</a>
        </li>
        
        </li>
      </ul>
    </div>
  </div>
</nav>

    <main class="page main-page">
        <div class="container blogPost">
    <div class="row">
        <div class="col-sm-9 px-md-5">
            <h2 class="blog-post-title">
                hashMap
            </h2>
            <p class="meta">
                <i class="far fa-clock"></i>
                2018-07-08 

<a href="/categories/Java/"><i class="far fa-folder-open"></i>
    Java </a>

            </p>
            <!-- Content -->
            <h3 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h3><h4 id="什么是HashMap"><a href="#什么是HashMap" class="headerlink" title="什么是HashMap"></a>什么是HashMap</h4><p>HashMap是一个散列桶（数组和链表），它存储的内容是键值对(key-value)映射</p>
<h4 id="为什么使用HashMap"><a href="#为什么使用HashMap" class="headerlink" title="为什么使用HashMap"></a>为什么使用HashMap</h4><ul>
<li>HashMap 采用了数组和链表的数据结构，极大限度发挥了数组和链表的优势</li>
<li>HashMap 是非同步的速度很快</li>
<li>HashMap 可以接受null的key 和value</li>
</ul>
<h4 id="HashMap的工作原理"><a href="#HashMap的工作原理" class="headerlink" title="HashMap的工作原理"></a>HashMap的工作原理</h4><p>HashMap是基于hashing的原理，添加数据的时候调用hashCode()方法，找到存储的位置，存储对象，然后获取数据的时候也是进行hashCode，然后找到存储的位置找到对象</p>
<h4 id="HashMap的put过程"><a href="#HashMap的put过程" class="headerlink" title="HashMap的put过程"></a>HashMap的put过程</h4><ul>
<li>对key进行hash,然后计算出下标</li>
<li>如果没有碰撞直接放入桶内</li>
<li>如果碰撞了，以链表的方式放到后面</li>
<li>如果链表长度超过8，就把链表转成链表，链表长度低于6的时候再把红黑树转成链表</li>
<li>如果结点已经存在，则替换之前的</li>
<li>如果数据数量到达到桶的*0.75（加载因子），就需要resize</li>
</ul>
<h4 id="有什么方法可以减少碰撞"><a href="#有什么方法可以减少碰撞" class="headerlink" title="有什么方法可以减少碰撞"></a>有什么方法可以减少碰撞</h4><ul>
<li><p>扰动函数可以减少碰撞，如果两个不相等的对象返回的hashcode值不一致，那么碰撞的几率就很小（扰动即Hash方法内部的算法实现，目的是让不同对象返回不同hashcode。）</p>
</li>
<li><p>使用不可变的、声明作final的对象并且采用合适的equals()和hashCode()方法的话，将会减少碰撞的发生。不可变性使得缓存不同键的hashcode,提高获取整个对象的速度使用String，Interger这样的wrapper类作为键是非常好的选择。</p>
</li>
</ul>
<p>为什么String, Interger这样的wrapper类适合作为键？</p>
<p>因为String 是fianl的，而且已经重写了equals()和hashcode方法，不可变性是必要的防止put get不一致导致取不出。</p>
<h4 id="HashMap-中的hash函数是怎么实现的"><a href="#HashMap-中的hash函数是怎么实现的" class="headerlink" title="HashMap 中的hash函数是怎么实现的"></a>HashMap 中的hash函数是怎么实现的</h4><ul>
<li>用hashcode 对数组的长度取余 1.8</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  static final int hash(Object key) &#123;</span><br><span class="line">        int h;</span><br><span class="line">        return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">h=hashCode():1111 1111 1111 1111 1111 0000 1110 1010</span><br><span class="line">---</span><br><span class="line">    h   :   1111 1111 1111 1111 1111 0000 1110 1010</span><br><span class="line">    h&gt;&gt;&gt;16: 0000 0000 0000 0000 1111 1111 1111 1111</span><br></pre></td></tr></table></figure>
<h4 id="tableSizeFor"><a href="#tableSizeFor" class="headerlink" title="tableSizeFor"></a>tableSizeFor</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">static final int tableSizeFor(int cap) &#123;</span><br><span class="line">        int n = cap - 1;</span><br><span class="line">        n |= n &gt;&gt;&gt; 1;</span><br><span class="line">        n |= n &gt;&gt;&gt; 2;</span><br><span class="line">        n |= n &gt;&gt;&gt; 4;</span><br><span class="line">        n |= n &gt;&gt;&gt; 8;</span><br><span class="line">        n |= n &gt;&gt;&gt; 16;</span><br><span class="line">        return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>由此可以看到，当在实例化HashMap实例时，如果给定了initialCapacity，由于HashMap的capacity都是2的幂，因此这个方法用于找到大于等于initialCapacity的最小的2的幂（initialCapacity如果就是2的幂，则返回的还是这个数）。 </p>
<h4 id="两个对象Hashcode-相同"><a href="#两个对象Hashcode-相同" class="headerlink" title="两个对象Hashcode 相同"></a>两个对象Hashcode 相同</h4><p>连个对象hashcode说明他们的bucket位置相同，这就发生了碰撞，<br>hashMap 解决hash冲突的方法是链地址法，会把对象存入链表，在jdk1.8上<br>当链表长度达到8的时候，会转成红黑树，因为冲突数量多的话，那么链表的查询时间复杂啊的为O(m),红黑树是logn,红黑树是一种平衡二叉树，不是绝对的平衡，相对的平衡</p>
<p>红黑树定义：<br>1.跟节点是黑色的<br>2.每个叶子结点是黑色的空结点，也就是说叶子结点不存储数据<br>3.任何相邻的结点不同为红色，也就是说红色结点被黑色结点隔开的<br>4.每个结点到达可达结点的所有路径都包含相同数目的黑色结点</p>
<h4 id="拉链法导致的链表过深问题为什么不用二叉查找树代替，而选择红黑树？为什么不一直使用红黑树？"><a href="#拉链法导致的链表过深问题为什么不用二叉查找树代替，而选择红黑树？为什么不一直使用红黑树？" class="headerlink" title="拉链法导致的链表过深问题为什么不用二叉查找树代替，而选择红黑树？为什么不一直使用红黑树？"></a>拉链法导致的链表过深问题为什么不用二叉查找树代替，而选择红黑树？为什么不一直使用红黑树？</h4><ul>
<li>二叉树会在特殊情况下变成一条线性结构，这个跟原来链表一样了，遍历查找就会很慢，红黑树是平衡二叉树，随着结点增加，查找复杂度O(nlgN),通过左右旋，保持平衡，左右，如果链表长度很短的话，根本不需要引入红黑树，引入反而会慢</li>
</ul>
<p>#### </p>
<h4 id="两个键的hashcode相同如何获得值对象"><a href="#两个键的hashcode相同如何获得值对象" class="headerlink" title="两个键的hashcode相同如何获得值对象"></a>两个键的hashcode相同如何获得值对象</h4><p>get()方法根据hashcode 找到bucket的位置，如果这个bucket存有多个数据<br>将会遍历链表找到值的对象，</p>

            <br />
            <p class="meta">
                
            </p>
        </div>

        <div class="col-sm-3">
             
<span><b> TL;DR</b></span>
<p>
	Yet another hexo theme.
</p>
<hr />


<span><b> TL;DR 2</b></span>
<p>
	No, not another one :/
</p>
<hr />

 

<span
	><a href="https://twitter.com/hexojs" target="_blank" rel="noopener"
		><b
			><i class="fab fa-twitter-square"></i>
			<i class="fas fa-at"></i>
			hexojs</b
		></a
	></span
>
<br />
<a class="twitter-timeline" data-height="800" data-dnt="true" data-chrome="nofooter transparent noheader noborders " href="https://twitter.com/hexojs?ref_src=twsrc%5Etfw"></a>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


        </div>
    </div>
</div>
<!-- Menu fade on scroll -->
<script>
    var isScrolling;
    var prevScrollpos = window.pageYOffset;
    window.addEventListener(
        'scroll',
        function(event) {
            window.clearTimeout(isScrolling);
            isScrolling = setTimeout(function() {
                var currentScrollPos = window.pageYOffset;
                if (prevScrollpos > currentScrollPos) {
                    $('#navbar').slideDown();
                } else {
                    $('#navbar').slideUp();
                }
                prevScrollpos = currentScrollPos;
            }, 66);
        },
        false
    );
</script>



<a class="float-right gradient btn paginationbtn" href="/2018/07/09/Java内存模型/"><i class="fas fa-chevron-right"></i></a>

    </main>
    <!-- Footer -->
    <footer class="page-footer">
  <div class="container">
    <div class="social-icons">
      
      <a href="https://hexo.io/" title="Hexo.io" target="_blank" rel="noopener" class="fas fa-home"></a>
      
      <a href="https://twitter.com/hexojs" title="@hexojs" target="_blank" rel="noopener" class="fab fa-twitter"></a>
      
      <a href="https://github.com/RandomAdversary/Gradient/issues" title="Report issue" target="_blank" rel="noopener" class="fas fa-bug"></a>
      
    </div>
  </div>
</footer>
    <!-- After footer scripts -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
</body>

</html>